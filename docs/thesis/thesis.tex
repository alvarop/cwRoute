\documentclass{article}
\usepackage{graphicx}
\begin{document}
\title{ (thesis title?)\\
Masters Thesis}
\author{Alvaro Prieto\\
BS/MS Electrical Engineering\\
\texttt{axp8664@rit.edu}}
\maketitle

\pagebreak

\tableofcontents

\pagebreak

\begin{abstract}
...
\end{abstract}

\section{Summary of Contributions}
The following is a list of contributions presented in this work.
\begin{itemize}
\item \textbf{Software platform for WBAN research.} - The software platform was developed using only free and open source software (FOSS) tools. Radio libraries for the TI CC430 device were ported over from TI provided code and libraries for the CC2500 radio were written from scratch. Other features include timer control for scheduling and time-stamping, serial communication, some digital I/O, and analog input. Included in the platform were limited software tools for data capture and visualization on a host computer.

\item \textbf{Wireless ECG platform} - In order to test and demonstrate the WBAN platform, a wireless ECG system was implemented. The system included three wireless devices, an access point, and a host computer. Software for synchronized sampling was developed and tested successfully using the WBAN platform. Three ECG leads were sampled at 300Hz and displayed on a host computer in real-time.

\item \textbf{Software platform for routing algorithm development} - In order to develop a novel routing algorithm, a platform to test and compare with others was developed. The application uses Dijkstra's algorithm for best path selection, and allows for the testing of various link-cost functions. Both simulation and real-time operation are supported. One unique feature is the generation of routing graphic generation for network visualization.

\item \textbf{Specialized cost function for maximizing Body Area Network lifetime using global routing algorithms} - (Use abstract of paper here?)
\end{itemize}
% Include literature survey from other file
\input{sources/literature_survey} %uncomment to include literature survey


\section{Software Libraries}\label{sec:wbansoftwarelib}
One of the primary contributions of this project consists of software libraries for working with WBANs. Due to the project requirements, a choice was made to use free and open source tools, as opposed to proprietary software. Because of this choice, most of the radio libraries had to be either ported or re-written from scratch. There were two main hardware devices that were targeted in these libraries. The first consisted of a CC430 device, which has a built in 915MHz radio. The second was an MSP430 with an external CC2500 2.4GHz radio.

\subsection{Project History}
The first software libraries were initially developed by Corey Provencher, a student at RIT, for a senior design project. He developed a hardware board with a variety of sensors to measure body movements and the corresponding software to use it. All of his software development was done using the Texas Instruments (TI) software tools on Windows(TM).

Jeffery Robble, another student, took over and ported most of the code to use Linux based open source tools. The code ported over by Robble used TI's radio stack \emph{SimpliciTI}. Unfortunately, SimpliciTI was too complex and resource heavy to do time-sensitive operations, like clock synchronization, over the radio. It also required the use of other TI software libraries in order to work.

After Robble left, the work continued. The main goal of the project at the time was to develop wireless electrocardiogram(ECG)(Section~\ref{section:wirelessecg}). While planning for the wireless ECG, a decision was made to develop an entire WBAN platform that could later be used for other projects. The new platform would be developed in-house and included both hardware and software. Because of this, the entire library was to be written from the ground up. This would prevent any rights issues from coming up if published.

\subsection{Design Choices}
The decision to write all software libraries from scratch was not an easy one. Initially the SimpliciTI libraries were modified to try and meet the project needs, but this proved to be a complex task. Due to the simple nature of the planned WBAN, a much less complex approach could be used. The main application only required streaming data from various wireless sensors.$\ll$ Should I elaborate on the design constraints here? The number of devices is known, the time of transmission is known etc...$\gg$ This could be accomplished with a very minimal radio library.

\subsection{CC430 Device}
The first device used in this project was Provencher's initial hardware platform. Due to the limited quantities of that device, a new version of the hardware platform was developed. The new device removed all unused sensors from the board to minimize its footprint. It included a CC430 device with a 32.768Khz crystal oscillator for precise timekeeping. The analog-to-digital(A/D) ports were used to attach any needed sensors. The actual CC430 model used was the CC430x6137.

Libraries were written for serial communication, visual indicators, analog measurements, time synchronization and radio communications. The serial communication was used to transmit data to the host computer, while the rest were used in the wireless ECG application.

\subsection{MSP430-RF2500 Device}
The second major hardware platform was the MSP430-RF2500. This device is manufactured by TI and sold as a development platform. The MSP430-RF2500 device consists of an MSP430F2274 microcontroller and a CC2500 radio. There were several reasons why this device was used. The primary use for the MSP430-RF2500 was to develop the libraries to use the CC2500 radio. The next planned hardware platform for the project consisted of a CC430 with a CC2500. The previous software libraries would need to be expanded to include a second radio for communication.

Unlike the CC430, which has a radio core built in, the CC2500 is a standalone unit. In order to expedite the software development process, a working platform was needed. Software development new, untested, hardware is not a feasible option. Debugging both hardware and software simultaneously is not a good idea.

The previously developed CC430 libraries were ported to work with the MSP430 microcontroller and expanded to use the CC2500 radio. Features of the new radio libraries include power control, addressing and channel switching.

\section{Wireless ECG Application}\label{section:wirelessecg}
\subsection{Description}
The main goal of the Wireless ECG application is to produce the equivalent output of a traditional, wired, 12-lead ECG using three wireless sensors. 

The three main parts of the wireless ECG project are: 
\begin{itemize}
\item Developing the analog front-end to measure the biopotential signals from the subject.
\item Developing the software/firmware libraries to measure, store, and transmit the data from the EDs to the host.
\item Developing the lead reconstruction algorithms to convert the 3 measurements back to a physician friendly 12-lead display.
\end{itemize}
The work presented here focuses on the software/firmware development for the application.

\subsection{TinyOS Platform}
The first wireless ECG platform was developed using the Imperial College London BSN Motes, which use the TinyOS operating system. These devices are programmed in a derivative of the C language called NesC. While working with these devices and operating system was not particularly simple, the hardware worked, and had been used in other projects. A full 3-sensor wireless ECG application (minus the lead reconstruction) was implemented with these devices. Since the devices run an operating system, several, non-ideal, modifications were required to obtain precise time synchronization.

\subsection{CC430 Platform}
After demonstrating the system using the TinyOS devices, the development of the in-house system continued. After several hardware implementations, a similar 3-sensor wireless ECG application was developed. In contrast to the TinyOS system, the CC430 platform only used hardware and software that was developed by the team.

\subsection{Time Synchronization}
The method used compensates for time offsets between samples and minimizes the effect of clock drift by periodically synchronizing independent clock sources together. Figure~\ref{fig:network_layout} shows an example system consisting of three end devices (\emph{ED}s), one access point (\emph{AP}) and one host computer. 
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.4\textwidth]{figures/network-map-test2.pdf}
\end{center}
\caption{Test Network Layout}
\label{fig:network_layout}
\end{figure}
All devices have a timer used for time-stamping and synchronization. All events, including samples and data transfers, occur according to the value of the timer. Due to certain hardware limitations, the value of the timer cannot be altered, it can only be reset to zero. This does not, in any way, affect the synchronization of devices.

The timer inside the \emph{AP} can be considered the primary, or global, timer. The goal is to synchronize all \emph{ED}, or local, timers with the global timer. Whenever the global timer reaches its maximum value, and rolls over back to zero, the \emph{AP} sends a broadcast synchronization beacon instructing each end device it is time zero. When an \emph{ED} receives this message, it compares its current timer value to zero, to calculate the clock drift, and resets it to zero. This ensures that all \emph{ED} timers are aligned, which then allows measurements to occur at close to the same time.

While many, more precise, time synchronization methods are available~\cite{synchronization:FTSP}, it was determined that they were not needed. Due to the low sampling rate and the use of crystal oscillators to run the timers, the precision obtained with this simple method was good enough for the system. More complex methods would not have significantly improved results. Figure~\ref{fig:sync_data} shows the result of three separate wireless devices measuring the same signal. This method was used to confirm that the samples were aligned.

\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.8\textwidth]{figures/syncdata.pdf}
\end{center}
\caption{Synchronization Test}
\label{fig:sync_data}
\end{figure}

\subsection{Scheduling}
A round robin-like scheme is used to poll devices in the network. It focuses on simplicity and portability.

In previous implementations, each \emph{ED} was polled individually for sampled data, which required all \emph{ED}s to be on at all times. Once all device clocks are synchronized, polling is no longer necessary. Instead of sending poll messages to each device, the \emph{AP} just listens for \emph{ED} transmissions. The \emph{ED}s will wake up when they are scheduled to transmit and send the required data automatically. This method greatly reduces the power consumption of both \emph{AP} and \emph{ED}s. After initialization, the \emph{AP} only needs to send a periodic time synchronization beacon and the collected data back to the host computer. Once synchronized, end devices will only need to turn their receiver on around the time the synchronization beacon is expected.

Figure~\ref{fig:system_schedule} shows a sample system schedule. The figure shows the time each device is on, and the state of each radio. The ``sleep'' time for each \emph{ED} does not show when a device wakes up to sample data. In this specific case, the \emph{AP} has one extra time-slot allotted for a fourth \emph{ED}.

\begin{figure}[htb]
\begin{center}
\includegraphics[width=1\textwidth]{figures/sync_schedule.pdf}
\end{center}
\caption{System Schedule}
\label{fig:system_schedule}
\end{figure}

Certain devices can further reduce power consumption by sampling without using the main processor. This works by using direct-memory access(\emph{DMA}) which allows the analog-to-digital converter(\emph{ADC}) to store measurements in memory without first going through the processor. Using this method, Figure~\ref{fig:system_schedule} accurately presents the time each \emph{ED} is powered on. Sampling with DMA has not been implemented in the current wireless ECG platform.

\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.8\textwidth]{figures/heartbeats.pdf}
\end{center}
\caption{Sample Measurement from Single ECG Lead}
\label{fig:heartbeats}
\end{figure}

\subsection{Host Interface}
The primary focus of this project was to obtain synchronized samples from several wireless devices. A secondary, but important, goal was to display the data in real time. To speed up development, the live-plotting tool kst(http://kst-plot.kde.org/) was used. A application, written in C, communicated via a USB-to-Serial link with the AP and received all of the ED data. It then output the data to CSV files, which were then used as an input for kst. Figure~\ref{fig:heartbeats} shows an ECG lead wirelessly measured from a human subject.



\section{Algorithm Development Platform}
A platform for testing and analyzing new cost functions for global routing algorithms was developed in C. The platform allows for a network of nodes and links between the nodes to be created. It computes the best path from any node to a central source node. Finally, it produces various statistics, such as energy use, routing maps, and graphical visualizations.

Initially, the goal of the platform was to test and compare routing with various link costs in an efficient manner. After a good link cost function was found, it would then be implemented in a microcontroller and used. This did not turn out to be the case. The first problem encountered dealt with the network structure used for testing. The program required a list of nodes and a list of links between the nodes, along with the link costs. Developing a simulated network and links that accurately represented a real network was unfeasible. The choice was then made to closely couple the hardware design and the simulator.

The best way to come up with a network for simulation was to get all of the node and link information from a real network. The WBAN platform was then used to develop a system for measuring RSSI data between all nodes in a network. This system allowed for the capture of real network data, both nodes and links, that could later be used to run routing simulations. The new program auto-generated a list of nodes, links, and link costs from the previously-measured RSSI data. This new approach effectively removed the need to come up with special networks for testing. 

In order to better understand how the new routing system performed, a series of output files were generated during simulation. The program was set up to account for the energy use of each node as it routed packets through the network. Visualizing the energy use was vital for the analysis of network lifetime. Other available data included the routing information itself, which allowed for the analysis of the routes as the algorithm runs. Finally, the program produced a graphical output.

The graphical output began as a simple experiment to see a visual representation of the network. It was later expanded to generate graphs of the network, and all available connections, as the RSSI data was sampled. Due to the large number of links between all of the nodes, this graphic was not useful. The final implantation, which can be seen in Figure~\ref{fig:networkgraph1}, only displayed the links used in a specific round of routing. The link labels display the transmit power required by each node to meet the specific link.

\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.6\textwidth]{figures/networkgraph1.pdf}
\end{center}
\caption{Sample Network Visualization}
\label{fig:networkgraph1}
\end{figure}

\section{Specialized Cost Function for Maximizing Body Area Networks Lifetime Using Global Routing Algorithms}\label{sec:costfunction}
$\ll$ Insert most of the paper here. $\gg$

\section{Conclusion}
...

In Chapter\ref{sec:wbansoftwarelib},

\pagebreak

\listoffigures

%\listoftables

\bibliography{sources/thesis.bib}{}
\bibliographystyle{plain}
\end{document}